\subsection{AD-00-10: Simple Filtering of the LSST Alert Stream}
\label{ad-00-10}

\subsubsection{Requirements}

DMS-REQ-0342, DMS-REQ-0348, DMS-REQ-0343

\subsubsection{Test items}
\label{ag-00-10-items}

This test will demonstrate the ``mini-broker'' filtering service that returns a subset of alerts from the full stream identified by user-provided filters.

Specifically, this will demonstrate that:

\begin{itemize}

	\item{The filtering service can retrieve alerts from the full alert stream and filter them according to their contents;}
	\item{The filtered subset can be delivered to science users.}

\end{itemize}

This test does not include quantitative targets for latency.

\subsubsection{Intercase dependencies}

\begin{itemize}

  \item{\hyperref[ad-00-00]{AD-00-00}}
  \item{\hyperref[ad-00-05]{AD-00-05}}

\end{itemize}

\subsubsection{Environmental needs}

\paragraph{Hardware}

The test shall be carried out on a machine with at least 64\,GB of RAM and
16 CPU cores which has access to the \texttt{/datasets} shared (GPFS)
filesystem at the LSST Data Facility.

\paragraph{Software}

The Kafka cluster and Zookeeper shall be instantiated according to the 
procedure described in \hyperref[ad-00-00]{AD-00-00}).

\subsubsection{Input specification}

A sample of Avro-formatted alert packets derived from LSST simulations corresponding to one night of simulated LSST observing.

This dataset shall be made available in \texttt{/datasets}.  \textbf{exact path}

\subsubsection{Output specification}

Multiple Kafka consumers will run and write log files to disk.
The logs will include printing every \textbf{Nth} alert to to the log as well as a log summarizing the queue offset.


\subsubsection{Procedure}

\begin{enumerate}

  \item{start the mini-broker containers (10x) and set to listen to the Kafka system}

  \item{(instructions for configuring filters, if needed?)}

  \item{instructions for loading packets into running Kafka system---as in case ad-00-05}

  \item{run 100 consumers for generated filtered topics---as in case ad-00-05}

  \item{look at output log files---as in case ad-00-05}

\end{enumerate}
