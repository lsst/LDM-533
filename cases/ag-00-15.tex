\subsection{AG-00-15: Scientific Verification of Processed Visit Images}
\label{ag-00-15}

\subsubsection{Requirements}

DMS-REQ-0069, DMS-REQ-0327, DMS-REQ-0029, DMS-REQ-0070,
DMS-REQ-0030, DMS-REQ-0072.

\subsubsection{Test items}
\label{ag-00-15-items}

This test will check that the Processed Visit Images (PVIs) delivered by the
alert generation science payload meet the requirements laid down by \citeds{LSE-61}.

Specifically, this will demonstrate that:

\begin{itemize}

  \item{Processed visit images have been generated and persisted during
  payload execution;}
  \item{Each PVI includes a background model (DMS-REQ-0327), photometric
  zero-point (DMS-REQ-0029), spatially-varying PSF (DMS-REQ-0070) and WCS
  (DMS-REQ-0030).}
  \item{PSF models correctly predict the ellipticities of stars over the field of view.}
  \item{Saturated pixels are correctly masked.}
  \item{Pixels affected by cosmic rays are correctly masked.}
  \item{The background is not oversubtracted around bright objects.}

\end{itemize}

This test does not include quantitative targets for the science quality criteria; we instead require for each test that we be able to quickly construct a plot or display summary images that allow such a target can be visualized.

\subsubsection{Intercase dependencies}

\begin{itemize}

  \item{\hyperref[ag-00-00]{AG-00-00}}
  \item{\hyperref[ag-00-10]{AG-00-10}}

\end{itemize}

\subsubsection{Environmental needs}

\paragraph{Hardware}

The test shall be carried out on a machine with at least 16\,GB of RAM and
multiple CPU cores which has access to the \texttt{/datasets} shared (GPFS)
filesystem at the LSST Data Facility.

\paragraph{Software}

Release 14.0 of the DM Software Stack will be pre-installed (following the
procedure described in \hyperref[ag-00-00]{AG-00-00}).

\subsubsection{Input specification}

A complete processing of the DECam ``HiTS'' dataset, as defined at
\url{https://dmtn-039.lsst.io/} and
\url{https://github.com/lsst/ap_verify_hits2015}, through the Alert
Generation science payload.

This dataset shall be made available in a standard LSST data repository,
accessible via the ``Data Butler''.

It is not required that all combinations of visit and CCD have been processed
successfully: a number of failures are expected. However, documentation to
describe processing failures should be provided.

\subsubsection{Output specification}

None.

\subsubsection{Procedure}

\begin{itemize}

  \item{The DM Stack shall be initialized using the \texttt{loadLSST} script
  (as described in \hyperref[ag-00-00]{AG-00-00}).}

  \item{A ``Data Butler'' will be initialized to access the repository.}

  \item{For each processed CCD, the PVI will be retrieved from the Butler, and
  the existence of all components described in \S\ref{ag-00-15-items} will be
  verified.}

  \item{Scripts from the \texttt{pipe\_analysis} package will be run on
	  every visit to check for the presence of data products and make
		plots.}

  \item{Five sensors will be chosen at random from each of two visits and inspected by eye for unmasked artifacts.}

\end{itemize}
